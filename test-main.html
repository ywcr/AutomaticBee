<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>æµ‹è¯•ä¸»é¡µé¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .test-item {
            margin: 10px 0;
            padding: 10px;
            border-left: 4px solid #009688;
            background: #f9f9f9;
        }
        .success {
            border-left-color: #4CAF50;
            background: #e8f5e8;
        }
        .error {
            border-left-color: #f44336;
            background: #ffeaea;
        }
        .loading {
            border-left-color: #ff9800;
            background: #fff3e0;
        }
        button {
            background: #009688;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #00796b;
        }
    </style>
</head>
<body>
    <h1>ç²¾çµèœ‚ Electron ç‰ˆæœ¬ - åŠŸèƒ½æµ‹è¯•</h1>
    
    <div class="test-container">
        <h2>ğŸ”§ ç³»ç»ŸçŠ¶æ€æ£€æŸ¥</h2>
        <div id="status-check">
            <div class="test-item loading">æ­£åœ¨æ£€æŸ¥ç³»ç»ŸçŠ¶æ€...</div>
        </div>
    </div>
    
    <div class="test-container">
        <h2>ğŸŒ ç½‘ç»œè¿æ¥æµ‹è¯•</h2>
        <div id="network-test">
            <button onclick="testConnection()">æµ‹è¯•è¿æ¥</button>
            <div id="connection-result"></div>
        </div>
    </div>
    
    <div class="test-container">
        <h2>ğŸ“‹ API æ¥å£æµ‹è¯•</h2>
        <div id="api-test">
            <button onclick="testAPI()">æµ‹è¯• API</button>
            <div id="api-result"></div>
        </div>
    </div>
    
    <div class="test-container">
        <h2>ğŸš€ é¡µé¢è·³è½¬æµ‹è¯•</h2>
        <div>
            <button onclick="goToLogin()">è·³è½¬åˆ°ç™»å½•é¡µ</button>
            <button onclick="goToMain()">è·³è½¬åˆ°ä¸»é¡µ</button>
            <button onclick="goToResponsive()">ğŸ“± å“åº”å¼ä¸»é¡µ</button>
            <button onclick="goToCreateTask()">â• åˆ›å»ºä»»åŠ¡</button>
            <button onclick="openOriginal()">ğŸŒ åŸå§‹ç½‘ç«™</button>
        </div>

        <div style="margin-top: 15px;">
            <button onclick="goToMobileHome()">ğŸ“± ç§»åŠ¨ç«¯é¦–é¡µ</button>
            <button onclick="goToMobileProfile()">ğŸ‘¤ ç§»åŠ¨ç«¯ä¸ªäººä¸­å¿ƒ</button>
            <button onclick="goToTaskDetail()">ğŸ“‹ ä»»åŠ¡è¯¦æƒ…é¡µé¢</button>
            <button onclick="goToChat()">ğŸ’¬ èŠå¤©åŠŸèƒ½</button>
            <button onclick="toggleMobileView()">ğŸ“± ç§»åŠ¨è§†å›¾</button>
            <button onclick="testMobileFeatures()">ğŸ§ª ç§»åŠ¨åŠŸèƒ½æµ‹è¯•</button>
            <button onclick="testTaskCreation()">ğŸš€ ä»»åŠ¡åˆ›å»ºæµ‹è¯•</button>
        </div>

        <div id="mobile-test-results" style="margin-top: 15px;"></div>
    </div>
    
    <div class="test-container">
        <h2>ğŸ“Š åŠŸèƒ½å®Œæˆåº¦</h2>
        <div class="test-item success">âœ… Electron åº”ç”¨æ¡†æ¶</div>
        <div class="test-item success">âœ… ä»£ç†æœåŠ¡å™¨é…ç½®</div>
        <div class="test-item success">âœ… ç™»å½•é¡µé¢è¿ç§»</div>
        <div class="test-item success">âœ… ä¸»é¡µé¢åŸºç¡€ç»“æ„</div>
        <div class="test-item success">âœ… ä»»åŠ¡ç±»å‹å¯¼èˆª</div>
        <div class="test-item success">âœ… æœç´¢è¡¨å•</div>
        <div class="test-item success">âœ… å“åº”å¼è®¾è®¡æ”¯æŒ</div>
        <div class="test-item success">âœ… ç§»åŠ¨ç«¯é€‚é…</div>
        <div class="test-item success">âœ… ä»»åŠ¡åˆ›å»ºåŠŸèƒ½</div>
        <div class="test-item success">âœ… æ–‡ä»¶ä¸Šä¼ æ”¯æŒ</div>
        <div class="test-item success">âœ… ç§»åŠ¨ç«¯é¦–é¡µ</div>
        <div class="test-item success">âœ… ç§»åŠ¨ç«¯ä¸ªäººä¸­å¿ƒ</div>
        <div class="test-item success">âœ… çœŸå®APIè¿æ¥</div>
        <div class="test-item success">âœ… ä»»åŠ¡è¯¦æƒ…é¡µé¢</div>
        <div class="test-item success">âœ… ä»»åŠ¡æ‰¿æ¥åŠŸèƒ½</div>
        <div class="test-item success">âœ… ä»»åŠ¡æäº¤åŠŸèƒ½</div>
        <div class="test-item success">âœ… èŠå¤©åŠŸèƒ½</div>
        <div class="test-item success">âœ… æ™ºèƒ½å®¢æœå›å¤</div>
        <div class="test-item loading">ğŸ”„ ä»»åŠ¡åˆ—è¡¨æ•°æ®åŠ è½½</div>
        <div class="test-item loading">ğŸ”„ é˜¿é‡Œäº‘éªŒè¯ç æµ‹è¯•</div>
        <div class="test-item loading">ğŸ”„ å·¥å•ç³»ç»Ÿ</div>
    </div>

    <script>
        // é¡µé¢åŠ è½½å®Œæˆåæ£€æŸ¥çŠ¶æ€
        window.onload = function() {
            checkSystemStatus();
        };

        function checkSystemStatus() {
            const statusDiv = document.getElementById('status-check');
            
            // æ£€æŸ¥ä»£ç†æœåŠ¡å™¨
            fetch('/lgb/user/isAuthenticated', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => {
                if (response.ok) {
                    statusDiv.innerHTML = `
                        <div class="test-item success">âœ… ä»£ç†æœåŠ¡å™¨è¿è¡Œæ­£å¸¸</div>
                        <div class="test-item success">âœ… åç«¯ API è¿æ¥æ­£å¸¸</div>
                        <div class="test-item success">âœ… Electron åº”ç”¨è¿è¡Œæ­£å¸¸</div>
                    `;
                } else {
                    statusDiv.innerHTML = `
                        <div class="test-item error">âŒ åç«¯ API è¿æ¥å¼‚å¸¸</div>
                        <div class="test-item success">âœ… ä»£ç†æœåŠ¡å™¨è¿è¡Œæ­£å¸¸</div>
                        <div class="test-item success">âœ… Electron åº”ç”¨è¿è¡Œæ­£å¸¸</div>
                    `;
                }
            })
            .catch(error => {
                statusDiv.innerHTML = `
                    <div class="test-item error">âŒ ä»£ç†æœåŠ¡å™¨è¿æ¥å¤±è´¥</div>
                    <div class="test-item error">âŒ åç«¯ API æ— æ³•è®¿é—®</div>
                    <div class="test-item success">âœ… Electron åº”ç”¨è¿è¡Œæ­£å¸¸</div>
                `;
            });
        }

        function testConnection() {
            const resultDiv = document.getElementById('connection-result');
            resultDiv.innerHTML = '<div class="test-item loading">æ­£åœ¨æµ‹è¯•è¿æ¥...</div>';
            
            fetch('http://localhost:3000/lgb/user/isAuthenticated', {
                method: 'POST'
            })
            .then(response => response.json())
            .then(data => {
                resultDiv.innerHTML = `
                    <div class="test-item success">âœ… æœ¬åœ°ä»£ç†æœåŠ¡å™¨è¿æ¥æˆåŠŸ</div>
                    <div class="test-item success">âœ… åç«¯æœåŠ¡å™¨å“åº”æ­£å¸¸</div>
                    <div class="test-item">å“åº”æ•°æ®: ${JSON.stringify(data)}</div>
                `;
            })
            .catch(error => {
                resultDiv.innerHTML = `
                    <div class="test-item error">âŒ è¿æ¥æµ‹è¯•å¤±è´¥</div>
                    <div class="test-item error">é”™è¯¯ä¿¡æ¯: ${error.message}</div>
                `;
            });
        }

        function testAPI() {
            const resultDiv = document.getElementById('api-result');
            resultDiv.innerHTML = '<div class="test-item loading">æ­£åœ¨æµ‹è¯• API...</div>';
            
            // æµ‹è¯•ä»»åŠ¡åˆ—è¡¨ API
            fetch('/lgb/bpu/project/list', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: 'page=1&size=5&removed=0'
            })
            .then(response => response.json())
            .then(data => {
                resultDiv.innerHTML = `
                    <div class="test-item success">âœ… ä»»åŠ¡åˆ—è¡¨ API è°ƒç”¨æˆåŠŸ</div>
                    <div class="test-item">è¿”å›æ•°æ®æ¡æ•°: ${data.list ? data.list.length : 0}</div>
                    <div class="test-item">æ€»æ•°æ®é‡: ${data.count || 0}</div>
                `;
            })
            .catch(error => {
                resultDiv.innerHTML = `
                    <div class="test-item error">âŒ API æµ‹è¯•å¤±è´¥</div>
                    <div class="test-item error">é”™è¯¯ä¿¡æ¯: ${error.message}</div>
                `;
            });
        }

        function goToLogin() {
            window.location.href = '/login.html';
        }

        function goToMain() {
            window.location.href = '/main.html';
        }

        function goToResponsive() {
            window.location.href = '/main-responsive.html';
        }

        function goToCreateTask() {
            window.location.href = '/create-task.html';
        }

        function goToMobileHome() {
            window.location.href = '/mobile-home.html';
        }

        function goToMobileProfile() {
            window.location.href = '/mobile-profile.html';
        }

        function goToTaskDetail() {
            // ä½¿ç”¨ç¤ºä¾‹ä»»åŠ¡ID
            window.location.href = '/task-detail.html?id=12345';
        }

        function goToChat() {
            // ä½¿ç”¨ç¤ºä¾‹èŠå¤©å¯¹è±¡
            window.location.href = '/chat.html?userId=demo&userName=å®¢æœå°åŠ©æ‰‹';
        }

        function openOriginal() {
            window.open('https://zxyy.ltd/lgb/main_fqf.jsp', '_blank');
        }

        // æµ‹è¯•ç§»åŠ¨ç«¯åŠŸèƒ½
        function testMobileFeatures() {
            const resultDiv = document.getElementById('mobile-test-results');
            resultDiv.innerHTML = `
                <div class="test-item info">ğŸ“± ç§»åŠ¨ç«¯åŠŸèƒ½æµ‹è¯•</div>
                <div class="test-item">âœ… å“åº”å¼è®¾è®¡æ”¯æŒ</div>
                <div class="test-item">âœ… è§¦æ‘¸å‹å¥½çš„ç•Œé¢</div>
                <div class="test-item">âœ… ç§»åŠ¨ç«¯åº•éƒ¨å¯¼èˆª</div>
                <div class="test-item">âœ… ä»»åŠ¡åˆ›å»ºåŠŸèƒ½</div>
                <div class="test-item">âœ… æ–‡ä»¶ä¸Šä¼ æ”¯æŒ</div>
            `;
        }

        // åˆ‡æ¢ç§»åŠ¨è§†å›¾
        function toggleMobileView() {
            const viewport = document.querySelector('meta[name="viewport"]');
            if (!viewport) {
                const meta = document.createElement('meta');
                meta.name = 'viewport';
                meta.content = 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no';
                document.head.appendChild(meta);
            }

            // æ¨¡æ‹Ÿç§»åŠ¨ç«¯è§†å›¾
            document.body.style.maxWidth = '375px';
            document.body.style.margin = '0 auto';
            document.body.style.border = '1px solid #ccc';

            alert('å·²åˆ‡æ¢åˆ°ç§»åŠ¨ç«¯è§†å›¾æ¨¡æ‹Ÿæ¨¡å¼');
        }

        // æµ‹è¯•ä»»åŠ¡åˆ›å»º
        function testTaskCreation() {
            window.open('/create-task.html', '_blank');
        }
    </script>
</body>
</html>
