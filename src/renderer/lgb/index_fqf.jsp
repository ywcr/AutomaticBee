




<!DOCTYPE html>
<html style="height:100%">
<head>
    <title>ä¼ä¸šæ‰¿æ¥ä»»åŠ¡</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="referrer" content="never">
    <meta charset="UTF-8">
    <link rel="icon" href="images/jp.png" type="image/x-icon">
    <link rel="stylesheet" href="layui/css/layui.css">
    <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="css/animate.min.css" rel="stylesheet"/>
    <link href="css/index.css" rel="stylesheet"/>
    <link href="css/pc_chat.css" rel="stylesheet"/>
    <link rel="stylesheet" href="/lgb/css/QVerify.min.css">
    <script src="layui/layui.js"></script>
    <link rel="stylesheet" href="./js/element/index.css" />
    <!-- å›½å†…ä½¿ç”¨ -->
    <script type="text/javascript" charset="utf-8" src="//g.alicdn.com/sd/ncpc/nc.js?t=2015052012"></script>

    <script type="text/javascript" src="./js/BonreeSDK_TDEM_JS.v2.4.5/BonreeSDK_JS.min.js" data="%7B%22reqHeaderTraceKey%22%3A%5B%22tracestate%22%2C%22traceparent%22%5D%2C%22uploadAddrHttps%22%3A%22https%3A%2F%2Foneupload.bonree.com%2FRUM%2Fupload%22%2C%22mc%22%3A%5B%7B%22n%22%3A%22sessionreplay%22%2C%22c%22%3A100%2C%22src%22%3A%7B%22sl%22%3A2%2C%22uc%22%3A15%2C%22ua%22%3A%22http%3A%2F%2Foneupload.bonree.com%2FRUM%2FuploadReplay%22%2C%22uas%22%3A%22https%3A%2F%2Foneupload.bonree.com%2FRUM%2FuploadReplay%22%7D%7D%2C%7B%22n%22%3A%22network%22%2C%22cs%22%3A%7B%22fc%22%3A0%7D%7D%5D%2C%22appId%22%3A%2250ae3b7638e1447da22efe514448d28f%22%2C%22uploadAddrHttp%22%3A%22http%3A%2F%2Foneupload.bonree.com%2FRUM%2Fupload%22%2C%22respHeaderTraceKey%22%3A%5B%22traceresponse%22%2C%22x-br-response%22%5D%2C%22brss%22%3Afalse%7D" id="BonreeAgent" ></script>
    <!-- <script src="js/jquery.min.js"></script>

    <script src="js/awen-ajax.js"></script>
    <script src="js/index.js"></script>
    <script src="js/menu.js"></script>
    <script src="js/vue/vue.js"></script>
    <script src="js/element/index.js"></script>
    <script src="js/vue/qs.min.js"></script>
    <script type="text/javascript" src="js/QVerify.min.js"></script>
    <script type="text/JavaScript" src="js/util/crypto-js.min.js"></script> -->
    <style>
        /*ç®¡å®¶å¼¹å‡ºæ¡†çš®è‚¤*/
        body .steward {
            top: auto !important;
            left: auto !important;
            bottom: 64px;
            right: 0px;
            -moz-box-shadow: none !important;
            -webkit-box-shadow: none !important;
            box-shadow: none !important;
            text-align: center;
            background-color: transparent;
        }

        body .steward .layui-layer-title {
            background: rgb(136, 206, 196);
            font-size: 16px;
            text-shadow: 0 0 6px #1E9FFF;
            color: #fff;
            padding: 0;
            cursor: default !important;
            border: none;
        }

        body .steward .layui-layer-content {
            background: rgb(245, 249, 250);
            color: rgb(135, 135, 135);
            overflow: hidden;
        }

        .center-dialog{
            display: flex;
            flex-direction: column;
            margin:0 !important;
            position:absolute;
            top:50%;
            left:50%;
            transform:translate(-50%,-50%);
            /*height:600px;*/
            max-height:calc(100% - 30px);
            max-width:calc(100% - 30px);
        }
        .center-dialog .el-dialog__body{
            flex:1;
            overflow: auto;
        }
        .el-message--error{
								z-index: 99999999 !important;
							}
        .el-dialog__wrapper{
								z-index: 99999999 !important;
							}
         .business .el-dialog__header{
                border-bottom: 1px solid #f8f8f8;


         }
         .business{
            display: flex;
            flex-direction: column;
            margin:0 !important;
            position:absolute;
            top:50%;
            left:50%;
            transform:translate(-50%,-50%);
            /*height:600px;*/
            max-height:calc(100% - 30px);
            max-width:calc(100% - 30px);
         }
    </style>
</head>

<body style="height:100%;overflow:hidden;">

<!--ä¸ªæ€§åŒ–è®¾ç½®  lightSpeedIn-->
<div class="individuation animated  bounceOutLeft layui-hide">
    <form class="layui-form" lay-filter="settingFilter" style="height: 100%">
        <div class="setting-title">è®¾ç½®</div>
        <div class="setting-item layui-form">
            <span>æ¶ˆæ¯æé†’</span>
            <input type="checkbox" id="xxts" lay-skin="switch" lay-filter="sidenav" lay-text="ON|OFF" checked>
        </div>
        <div class="setting-title setting-title2">èœå•</div>

        <div id="menu-jsp" style="height: 100%">
            






<html>
    <body>
        <ul class="layui-nav layui-nav-tree layui-inline trt_more" lay-shrink="all" lay-filter="abc" style="height:100% !important;">
            
            <li class="layui-nav-item" id="fzs-sylxsj"><a href="javascript:;"><i class="fa fa-ambulance
            fa-fw"></i>å•†ä¸šæµå‘æ•°æ®</a></li>
            <li class="layui-nav-item" id="fzs-jplxsj"><a href="javascript:;"><i class="fa fa-ambulance
            fa-fw"></i>ç«å“æµå‘æ•°æ®</a></li>
            
        </ul>
    </body>
    <script>

        layui.use(['element', 'jquery'], function () {
            var element = layui.element;
            element.render('nav');
        })
        var cssFlag = localStorage.getItem("cssFlag");
            if(cssFlag === "trt") {
                document.body.setAttribute("cssFlag", "trt");
            }
    </script>
    <style>
        body[cssflag="trt"] .layui-layer-molv .layui-layer-title {
                background-color: white !important;
                color: black !important;
            }
    </style>
</html>

        </div>
    </form>
</div>

<div class="layui-layout layui-layout-admin">

    <div class="layui-header" style="background:#FFF;display: flex;">
        <div class="ht-nav-item" id="menuLi" style="width:100px;display:none">
            <a href="javascript:;" id="individuation"><i class="fa fa-tasks fa-fw"></i></a>
            <b style="position:absolute;left:40px;top:0px;color:#000;font-weight:bold;cursor: pointer;font-size: 17px;">èœå•</b>
        </div>

        
        <div class="navbar">
            <div style="display:flex;">
                <div class="layui-logo"><img src="images/jlf.png"></div>
                <div class="head_title" style="color:#000;font-family: cursive;font-size: 20px;width:120px">ä¼ä¸šä»»åŠ¡
                </div>
            </div>
            <ul class="layui-nav layui-layout-right" style="position: inherit !important;right:inherit;top:inherit;">
                <li class="layui-nav-item"><a href="main_fqf.jsp" target="page" id="mainBtn">é¦–é¡µ</a></li>
                <li class="layui-nav-item"><a href="javascript:void(0)" id="sso" style="display:none">ä¸ªäººä»»åŠ¡</a></li>
                
                
                <li class="layui-nav-item"><a href="javascript:void(0)" onclick="aboutUsOnclick('gztx')">è§„åˆ™ä½“ç³»</a></li>
                <li class="layui-nav-item"><a href="javascript:void(0)" onclick="aboutUsOnclick('bzzx')">å¸®åŠ©ä¸­å¿ƒ</a></li>
                <li class="layui-nav-item"><a href="javascript:void(0)" onclick="aboutUsOnclick('tzgg')">é€šçŸ¥å…¬å‘Š</a></li>

                <!-- <li class="layui-nav-item">
                    <a href="javascript:;">å…³äºæˆ‘ä»¬</a>
                    <dl class="layui-nav-child"> -->
                        <!-- <dd><a href="javascript:void(0)" onclick="aboutUsOnclick('qyjj')">ä¼ä¸šç®€ä»‹</a></dd> -->
                        <!-- <dd><a href="javascript:void(0)" onclick="aboutUsOnclick('cpjj')">äº§å“ç®€ä»‹</a></dd> -->
                        <!-- <dd><a href="javascript:void(0)" onclick="aboutUsOnclick('lxwm')">è”ç³»æˆ‘ä»¬</a></dd> -->
                        <!-- <dd><a href="javascript:void(0)" onclick="aboutUsOnclick('gztx')">è§„åˆ™ä½“ç³»</a></dd>
                        <dd><a href="javascript:void(0)" onclick="aboutUsOnclick('bzzx')">å¸®åŠ©ä¸­å¿ƒ</a></dd> -->
                        <!-- <dd><a href="javascript:void(0)" style="display: none;" id="tzgg"
                               onclick="aboutUsOnclick('tzgg')">é€šçŸ¥å…¬å‘Š</a></dd> -->
                        <!-- 
                        <dd><a href="javascript:void(0)" onclick="aboutUsOnclick('tzgg')">é€šçŸ¥å…¬å‘Š</a></dd>
                         -->
                    <!-- </dl>
                </li> -->
                <li class="layui-nav-item" id="u"><a href="javascript:void(0)" id="implementation">ç”¨æˆ·ç™»å½•</a></li>
                
            </ul>
        </div>
    </div>

    <div class="layui-body" style="overflow: hidden;bottom:0px" id="main">
        <iframe src="main_fqf.jsp" width="100%" height="100%" frameborder="0" allowtransparency="true"
                name="page"></iframe>
    </div>

</div>


<!-- å¿˜è®°å¯†ç  -->
<div id="forgetBox" style="display:none;padding:8px;text-align:center;">
    <form class="layui-form layui-form-pane" id="forgetForm" lay-filter="forgetForm">

        <input type="password" style="display:none">
        <div class="layui-form-item">
            <label class="layui-form-label" style="width:130px"><b>* </b>æ‰‹æœºå·ç </label>
            <div class="layui-input-block" style="margin-left:130px">
                <input type="text" name="phone" class="layui-input" lay-verify="required|account" autocomplete="off"
                       readonly onfocus="this.removeAttribute('readonly');">
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label" style="width:130px"><b>* </b>æ‰‹æœºéªŒè¯ç </label>
            <div class="layui-input-block" style="margin-left:130px">
                <input type="text" name="captcha" autocomplete="off" class="layui-input" lay-verify="required"
                       style="width:150px;float:left" readonly onfocus="this.removeAttribute('readonly');">
                <button type="button" class="layui-btn layui-btn-normal" id="yzmBtn2" style="width:106px">è·å–éªŒè¯ç 
                </button>
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label" style="width:130px"><b>* </b>ç™»å½•å¯†ç </label>
            <div class="layui-input-block" style="margin-left:130px">
                <input type="password" name="pwd" class="layui-input" lay-verify="pass"
                       onchange="inputTextLimits(this,value,'2')" placeholder="8~16ä½å­—æ¯/æ•°å­—/æ ‡ç‚¹åŠç‰¹æ®Šå­—ç¬¦"
                       autocomplete="off" readonly onfocus="this.removeAttribute('readonly');">
            </div>
        </div>

        <input type="hidden" name="sendTimestamp">
        <button class="layui-btn" style="width:130px;margin:0 auto;margin-top:10px;background:#4476a7" lay-submit>æäº¤
        </button>
    </form>
</div>

<!-- ç”¨æˆ·æ³¨å†Œ -->
<div id="registBox" style="display:none;padding:8px;text-align:center;">
    <form class="layui-form layui-form-pane" id="registForm" lay-filter="registForm">
        <div class="layui-form-item">
            <label class="layui-form-label" style="width:130px"><b>* </b>æ³¨å†Œç±»å‹</label>
            <div class="layui-input-block" style="margin-left:130px">
                <select name="registType" lay-filter="registType">
                    <option value="å·¥ä¸šä¼ä¸š">éœ€æ±‚æ–¹</option>
                    <option value="æœåŠ¡ä¼ä¸š">æœåŠ¡æ–¹</option>
                </select>
            </div>
        </div>

        <input type="password" style="display:none">
        <div class="layui-form-item" id="phoneDiv">
            <label class="layui-form-label" style="width:130px"><b>* </b>æ‰‹æœºå·ç </label>
            <div class="layui-input-block" style="margin-left:130px">
                <input type="text" name="phone" class="layui-input" lay-verify="required|account" autocomplete="off"
                       readonly onfocus="this.removeAttribute('readonly');">
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label" style="width:130px"><b>* </b>æ‰‹æœºéªŒè¯ç </label>
            <div class="layui-input-block" style="margin-left:130px">
                <input type="text" name="captcha" autocomplete="off" class="layui-input" lay-verify="required"
                       style="width:150px;float:left" readonly onfocus="this.removeAttribute('readonly');">
                <button type="button" class="layui-btn layui-btn-normal" id="yzmBtn" style="width:106px">è·å–éªŒè¯ç 
                </button>
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label" style="width:130px"><b>* </b>ç™»å½•å¯†ç </label>
            <div class="layui-input-block" style="margin-left:130px">
                <input type="password" name="pwd" class="layui-input" lay-verify="pass"
                       onchange="inputTextLimits(this,value,'2')" placeholder="8~16ä½å­—æ¯/æ•°å­—/æ ‡ç‚¹åŠç‰¹æ®Šå­—ç¬¦"
                       autocomplete="off" readonly onfocus="this.removeAttribute('readonly');">
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label" style="width:130px"><b>* </b>ç¡®è®¤å¯†ç </label>
            <div class="layui-input-block" style="margin-left:130px">
                <input type="password" name="pwd2" class="layui-input" lay-verify="repass"
                       onchange="inputTextLimits(this,value,'2')" placeholder="8~16ä½å­—æ¯/æ•°å­—/æ ‡ç‚¹åŠç‰¹æ®Šå­—ç¬¦"
                       autocomplete="off" readonly onfocus="this.removeAttribute('readonly');">
            </div>
        </div>

        <div class="layui-form-item">
            <input type="checkbox" name="isRead" title="" lay-skin="primary">
            <span class="xygl yhzc"></span>
        </div>

        <input type="hidden" name="yhxyId" value="">
        <input type="hidden" name="yhxyName" value="">

        <input type="hidden" name="yszcId" value="">
        <input type="hidden" name="yszcName" value="">

        <input type="hidden" name="sendTimestamp">
        <button class="layui-btn" style="width:130px;margin:0 auto;margin-top:10px;background:#4476a7" lay-submit>æäº¤
        </button>
    </form>
</div>

<!-- æç¤º -->
<div id="tipsBox" style="display:none;padding:8px;text-align:center;background: #FFFFFF">
    <div class="layui-row">
        æ¸©é¦¨æç¤ºï¼šä¸ªäººä»»åŠ¡å†…å®¹ä»…å¯¹å·²ç™»å½•ç”¨æˆ·è¿›è¡Œå±•ç¤º
    </div>
</div>

<!-- ç™»å½•æ¡† -->
<div id="implementationBox" style="display:none;padding:8px;text-align:center;background: #FFFFFF">
    <form class="layui-form layui-form-pane" id="implementationForm" lay-filter="implementationForm">
        <input name="type" type="hidden">
        <input name="ignoreCaptcha" type="hidden" value="0">
        <div class="layui-form-item">
            <label class="layui-form-label" style="width:110px"><b>* </b>æ‰‹æœºå·ç </label>
            <div class="layui-input-block" style="margin-left:110px">
                <input type="text" name="phone" class="layui-input" lay-verify="required|phone" readonly
                       onfocus="this.removeAttribute('readonly');">
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label" style="width:110px"><b>* </b>ç™»å½•å¯†ç </label>
            <div class="layui-input-block" style="margin-left:110px">
                <input type="password" id="pwdPlaintext" name="pwdPlaintext" class="layui-input"
                       onchange="inputTextLimits(this,value,'2')" placeholder="8~16ä½å­—æ¯/æ•°å­—/æ ‡ç‚¹åŠç‰¹æ®Šå­—ç¬¦" readonly
                       onfocus="this.removeAttribute('readonly');">
                <input type="hidden" name="pwd">
                <input type="hidden" name="iv">
            </div>
        </div>
        <div class="layui-form-item mode-captcha" style="display: none">
            <label class="layui-form-label" style="width:110px"><b>* </b>éªŒè¯ç </label>
            <div class="layui-input-block" style="margin-left:110px">
                <input type="text" name="loginCaptcha" autocomplete="off" class="layui-input"
                       style="width:120px;float:left" readonly onfocus="this.removeAttribute('readonly');">
                <button type="button" class="layui-btn" id="getCaptchaBtn" style="width:106px">è·å–éªŒè¯ç </button>
            </div>
        </div>

        <div id="loginMsgInfo"
             style="font-size: 12px;text-align: left;color: red;margin-bottom: 15px;min-height: 10px;display: none;">
        </div>
        <input type="hidden" name="cssessionId">
        <input type="hidden" name="sig">
        <input type="hidden" name="token">
        <input type="hidden" name="scene" value="nc_login">
        <input type="hidden" name="appKey" value="FFFF0N0000000000B194">


        <div class="layui-form-item">
            <div id="your-dom-id" class="nc-container"></div>
        </div>


        
        
        
        
        
        


        <div class="layui-form-item">
           <span><input type="checkbox" name="isRemember" title="" lay-skin="primary">è®°ä½æ‰‹æœºå·å’Œå¯†ç 
           <a href="javascript:void(0)" style='color:#1E9FFF;text-decoration:underline;cursor:pointer'
              class="forgetPwd">å¿˜è®°å¯†ç </a></span>
        </div>
        <div id="QVerify"
             style="visibility: hidden;width:420px;height:600px;margin-top: -150px;position:absolute !important;"></div>
        <button class="layui-btn" id="loginSubmit" style="width:130px;margin:0 auto;" lay-submit>æäº¤
        </button>
        <button class="layui-btn layui-btn-primary" style="display:none;" id="reset">é‡ç½®éªŒè¯</button>
    </form>
</div>


<!-- æˆ‘çš„æ¶ˆæ¯æ¡† -->
<div id="myMsgBox" style="display:none;padding:5px;">
    <div class="layui-row" style="line-height:40px">
        <div class="layui-col-xs6" style="text-align:left">
            <button type="button" class="layui-btn layui-btn-sm layui-btn-warm" id="unread"><span
                class="layui-badge">8</span>æœªè¯»æ¶ˆæ¯
            </button>
            <button type="button" class="layui-btn layui-btn-sm layui-btn-normal" id="readed">å·²è¯»æ¶ˆæ¯</button>

            <button type="button" class="layui-btn layui-btn-sm layui-btn-primary" id="readAll">å…¨éƒ¨å·²è¯»</button>
        </div>
    </div>

    <div class="layui-row" style="margin-top:10px;">
        <div class="layui-col-xs12" style="text-align:left">
            <input name="msgKey" class="layui-input" placeholder="è¯·è¾“å…¥å…³é”®å­—" style="width:60%;float:left">
            <button type="button" style="margin-left:20px" class="layui-btn " id="searchMsgBtn"><i class="layui-icon">&#xe615;</i>æœç´¢
            </button>
        </div>
    </div>

    <div id="allMsg">
    </div>

</div>

<!-- æ–‡ä»¶ä¸‹è½½   -->
<form name="downForm" id="downForm" method="post" style="display:none">
    <iframe name="downFrame" style="display:none"></iframe>
</form>


<!-- é‡ç½®å¯†ç Box -->
<div style="display:none;padding:5px;text-align: center" id="czmmBox">
    <form class='layui-form layui-form-pane' id="czmmForm">

        <div class="layui-form-item">
            <label class="layui-form-label" style="width:120px"><b style="color:red">* </b>åŸå¯†ç </label>
            <div class="layui-input-block" style="margin-left:120px">
                <input type="password" name="oldPwd" class="layui-input" autocomplete="off" placeholder="è¯·è¾“å…¥"
                       lay-verify="required"
                       readonly onfocus="this.removeAttribute('readonly');"
                       onblur="this.setAttribute('readonly','readonly');">
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label" style="width:120px"><b style="color:red">* </b>æ–°å¯†ç </label>
            <div class="layui-input-block" style="margin-left:120px">
                <input type="password" name="pwd" class="layui-input" lay-verify="pass"
                       onchange="inputTextLimits(this,value,'2')" placeholder="8~16ä½å­—æ¯/æ•°å­—/æ ‡ç‚¹åŠç‰¹æ®Šå­—ç¬¦"
                       autocomplete="off"
                       readonly onfocus="this.removeAttribute('readonly');"
                       onblur="this.setAttribute('readonly','readonly');">
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label" style="width:120px"><b style="color:red">* </b>ç¡®è®¤æ–°å¯†ç </label>
            <div class="layui-input-block" style="margin-left:120px">
                <input type="password" name="pwd2" class="layui-input" lay-verify="repass2"
                       onchange="inputTextLimits(this,value,'2')" placeholder="8~16ä½å­—æ¯/æ•°å­—/æ ‡ç‚¹åŠç‰¹æ®Šå­—ç¬¦"
                       autocomplete="off"
                       readonly onfocus="this.removeAttribute('readonly');"
                       onblur="this.setAttribute('readonly','readonly');">
            </div>
        </div>

        <button type="button" class="layui-btn repasswd">æäº¤</button>
    </form>
</div>

<img id="imgBox" alt="" src="" style="display:none">

<!-- èŠå¤©çª—å£ -->
<div style="display:none" id="kfBox">
    <div id="chatSearchDiv"><i class="layui-icon layui-icon-search"></i><input class='layui-input' name='key'
                                                                               placeholder='æœç´¢' autocomplete="off">
    </div>
    <ul class="layui-unselect layim-chat-list" style="/* height: 520px; */height:482px; display: block;">
    </ul>
    <div style="margin-left:300px;width:600px" id="rightBox">
        <div id="kfDiv">
            <div class="layim-chat-title" style="position: absolute;top:-80px;height:80px;">
                <div class="layim-chat-other"><img src="">
                    <span class="layim-chat-username"> </span>
                    <p class="layim-chat-status"></p>
                </div>
            </div>
            <div id="chat_main" style="padding-top:20px"></div>
        </div>
        <textarea id="sendContent" style="display: none;"></textarea>
        <div style="height:46px">
            <button type="button" class="layui-btn layui-btn-sm"
                    style="margin-right:10px;margin-top:8px;float:right;padding:0 20px;background:#5FB878"
                    onclick="sendChat()">å‘é€
            </button>

            <button type="button" class="layui-btn layui-btn-warm layui-btn-sm"
                    style="margin-right:10px;margin-top:8px;float:right;display:none" id="xzBtn">é€‰æ‹©æ²Ÿé€šç”¨è¯­
            </button>
        </div>
    </div>
</div>


<!--æ²Ÿé€šç”¨è¯­é€‰æ‹©æ¡†-->
<div style="display:none;padding:5px;text-align:center;" id="chooseBox">
    <form class="layui-form" lay-filter="chooseForm">
        <div class="layui-input-block" style="margin:0 auto;width:200px;float:left;margin-top:4px">
            <select name="classify" lay-filter="classifySel">
            </select>
        </div>
        <button class="layui-btn" type="button" id="add" style="float:left;margin:4px 0px 0px 20px"><i
            class="layui-icon layui-icon-add-circle"></i>æ–°å¢
        </button>
        <table class="layui-table" id="proTable" lay-filter="proTable"></table>
    </form>
</div>

<!-- æ²Ÿé€šç”¨è¯­ç¼–è¾‘æ¡† -->
<div style="display:none;padding:5px;text-align:center;" id="saveBox">
    <form class="layui-form" lay-filter="saveForm" id="saveForm">
        <input type="hidden" name="id">
        <div class="layui-form-item">
            <label class="layui-form-label"><b>* </b>åˆ†ç±»åç§°</label>
            <div class="layui-input-block">
                <input name="classify" class="layui-input" lay-verify="required" style="width:280px">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label"><b>* </b>æ²Ÿé€šè¯­å¥</label>
            <div class="layui-input-block">
                <input name="sentence" class="layui-input" lay-verify="required" style="width:280px">
            </div>
        </div>
        <button type="button" lay-submit lay-filter="saveOk" class="layui-btn"><i class="layui-icon layui-icon-ok"></i>ä¿å­˜
        </button>
    </form>
</div>


<div id="xy_zc_box" style="display:none;padding:15px;text-align:center;">
    <form id="xyzcForm">
        <input type="hidden" name="empId" value="">
        <input type="hidden" name="empType" value="">
        <input type="hidden" name="newYhxyId" value="">
        <input type="hidden" name="newYhxyName" value="">
        <input type="hidden" name="newYszcId" value="">
        <input type="hidden" name="newYszcName" value="">
    </form>
    <img src="images/jp_index.png" style="height:50px">
    <p style="font-weight:600;text-align:left;line-height:30px;margin-top:10px">ç”¨æˆ·åè®®ä¸éšç§æ”¿ç­–</p>
    <p style="text-indent:20px;text-align:left;line-height:28px">æˆ‘ä»¬éå¸¸é‡è§†æ‚¨çš„éšç§ä¿æŠ¤å’Œä¸ªäººä¿¡æ¯ä¿æŠ¤,æ‚¨åœ¨ä½¿ç”¨ç²¾çµèœ‚äº§å“å‰,
        è¯·åŠ¡å¿…è®¤çœŸé˜…è¯»ã€Šç”¨æˆ·åè®®ã€‹å’Œã€Šéšç§æ”¿ç­–ã€‹çš„å…¨éƒ¨æ¡æ¬¾ã€‚æ‚¨åŒæ„å¹¶æ¥å—å…¨éƒ¨æ¡æ¬¾å,ç²¾çµèœ‚äº§å“æ‰èƒ½æ­£å¸¸ä¸ºæ‚¨æä¾›ç›¸å…³æœåŠ¡ã€‚</p>
    <p style="text-indent:20px;text-align:left;line-height:28px">ç²¾çµèœ‚é«˜åº¦é‡è§†ç”¨æˆ·ä¸ªäººä¿¡æ¯ä¿æŠ¤å·¥ä½œ,éšç§æ”¿ç­–å†…å®¹åŒ…æ‹¬ç”¨æˆ·ä¸ªäºº
        ä¿¡æ¯(å§“åã€èº«ä»½è¯ã€æ‰‹æœºå·)çš„æ”¶é›†ã€ä½¿ç”¨è®¾å¤‡æƒé™è°ƒç”¨ç­‰å†…å®¹,è¯·æ‚¨ä»”ç»†é˜…è¯»ã€‚</p><br>
    <p style="text-align:left">åè®®å†…å®¹å¦‚ä¸‹:</p>
    <p style="text-align:left;line-height:32px"><span class="xyzc"></span></p>

    <div style="margin-top:30px">
        <button type="button" class="layui-btn" style="width:160px;background:#DCDCDC;color:#AEB2C1" id="xyzc_no">æš‚ä¸ä½¿ç”¨
        </button>
        <button type="button" class="layui-btn" style="width:160px;background:#FFE100" id="xyzc_yes">åŒæ„</button>
    </div>
</div>

<div id="platformReidProtocolLayer" style="display:none;padding:15px;text-align:center;">
    <img src="images/jlf.png" style="height:50px">
    <p style="font-weight:600;text-align:left;line-height:30px;margin-top:10px">å¹³å°å…¥é©»åè®®å˜æ›´é€šçŸ¥</p>
    <p style="text-indent:20px;text-align:left;line-height:28px">æˆ‘ä»¬éå¸¸é‡è§†æ‚¨çš„æƒç›Š,æ‚¨åœ¨ä½¿ç”¨ç²¾çµèœ‚äº§å“å‰,
        è¯·åŠ¡å¿…è®¤çœŸé˜…è¯»ã€Šå¹³å°å…¥é©»åè®®ã€‹çš„å…¨éƒ¨æ¡æ¬¾ï¼›é‡ç‚¹é˜…è¯»åŠ ç²—ã€å¸¦æœ‰ä¸‹åˆ’çº¿çš„å†…å®¹ã€‚</p>
    <p style="text-indent:20px;text-align:left;line-height:28px">
        æ‚¨åŒæ„ç­¾ç½²æœ¬åè®®å³æ„å‘³ç€æ‚¨ä½¿ç”¨ç²¾çµèœ‚å¹³å°è´¦æˆ·æ‰€ç”³è¯·è®¤è¯çš„ä¸»ä½“è‡ªæ„¿æ¥å—æœ¬åè®®çº¦æŸã€‚å¦‚æœæ‚¨å¯¹æœ¬åè®®çš„æ¡æ¬¾æœ‰ç–‘é—®ï¼Œè¯·é€šè¿‡ç²¾çµèœ‚å¹³å°å®¢æœæ¸ é“è¿›è¡Œè¯¢é—®ï¼Œç²¾çµèœ‚å¹³å°å°†å‘æ‚¨è§£é‡Šæ¡æ¬¾å†…å®¹ã€‚</p>
    <br>
    <p style="text-align:left;text-indent:20px">è¯·æ‚¨ä»”ç»†é˜…è¯»ã€‚</p>
    <p style="text-align:left;text-indent:20px">åè®®å†…å®¹å¦‚ä¸‹:</p>
    <p style="text-align:left;line-height:32px;text-indent:20px"><span
        style="cursor: pointer;text-decoration:underline;color:#1090ef"
        onclick="showPlatformReidProtocol()">ã€Šå¹³å°å…¥é©»åè®®ã€‹</span></p>
    <div style="margin-top:30px">
        <button type="button" class="layui-btn xyzc_no" style="width:160px;background:#DCDCDC;color:#AEB2C1">æš‚ä¸ä½¿ç”¨
        </button>
        <button type="button" class="layui-btn" style="width:160px;background:#FFE100"
                onclick="platformReidProtocolAutoSign()">åŒæ„
        </button>
    </div>
</div>

<div id="vue">
    <div id="timeVisible" style="display: none;">
        <el-dialog
            align-center  width="700px"
            :visible.sync="timeVisible"
            :show-close="false"
            width="30%" style="margin-top: 25vh">
            <span slot="title">
                <i class="el-icon-warning-outline" style="color: #1090ef; font-size: 18px;"></i><span style="font-size: 18px; margin-left: 6px;">{{timeTitle}}</span>
            </span>
            <span>{{timeMessage}}</span>
            <span slot="footer" class="dialog-footer">
                <el-button @click="timeVisible = false">ç¨åå¤„ç†</el-button>
                <el-button type="primary" @click="goAuthorize">å»æˆæƒ</el-button>
            </span>
        </el-dialog>
    </div>
    <div id="myDialog"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 99999999">
        <!--ç”µå­ç­¾ç« æœåŠ¡å¼¹çª—-->
        <el-dialog  :show-close="flag"  :visible.sync="dialogVisible" width="30%" :modal-append-to-body="true"
            style="background: rgba(0, 0, 0, 0.3)" custom-class="fullscreen-dialog" :before-close="shutDown">
            <template slot="title">
                <div style="height: 50px; line-height: 50px; font-size: 20px">
                    <i class="el-icon-warning-outline"
                        style="color: #1090ef; margin-right: 10px; font-size: 26px"></i>ç”µå­ç­¾æœåŠ¡å¼€é€šæé†’
                </div>
            </template>

            <div style="margin-top: 10px">
                æ‚¨çš„ä¼ä¸šæœªå¼€é€šç”µå­ç­¾æœåŠ¡ã€‚è¯·å°½å¿«å¼€é€šï¼Œä»¥ç¡®ä¿å·¥ä½œé¡ºåˆ©è¿›è¡Œã€‚
            </div>

            <span slot="footer" class="dialog-footer">
                <el-button @click="shutDown" v-if="flag">å– æ¶ˆ</el-button>
                <el-button @click="openUp" type="primary">å»å¼€é€š</el-button>
            </span>
        </el-dialog>
    </div>
    <div id="youDialog" style="display: none;">
        <el-dialog title="è¯æ®é“¾ç»Ÿè®¡æŠ¥å‘Šç­¾ç½²æé†’" custom-class="center-dialog"  align-center :visible.sync="tip" width="500px" :before-close="dClose">
            <template slot="title">
                <div style="height: 50px; line-height: 50px; font-size: 20px">
                    <i class="el-icon-warning-outline"
                        style="color: #1090ef; margin-right: 10px; font-size: 26px"></i>è¯æ®é“¾ç»Ÿè®¡æŠ¥å‘Šç­¾ç½²æé†’
                </div>
            </template>
            <div style="width: 90%; margin: 0 auto">
                æ‚¨æœ‰
                <span style="color: red">{{ count }}</span>
                ä¸ªæœªç­¾ç½²çš„è¯æ®é“¾ç»Ÿè®¡æŠ¥å‘Šï¼Œè¯·å°½å¿«å®Œæˆç­¾ç½²ä»¥é¿å…å»¶è¯¯ã€‚
            </div>
            <span slot="footer" class="dialog-footer">
                <el-button @click="dClose">å– æ¶ˆ</el-button>
                <el-button type="primary" @click="goESign">å»ç­¾ç½²</el-button>
            </span>
        </el-dialog>
    </div>
        <div id="youDialog" style="display: none;">
        <el-dialog title="è¯æ®é“¾ç»Ÿè®¡æŠ¥å‘Šç­¾ç½²æé†’" custom-class="center-dialog"  align-center :visible.sync="tip" width="500px" :before-close="dClose">
            <template slot="title">
                <div style="height: 50px; line-height: 50px; font-size: 20px">
                    <i class="el-icon-warning-outline"
                        style="color: #1090ef; margin-right: 10px; font-size: 26px"></i>è¯æ®é“¾ç»Ÿè®¡æŠ¥å‘Šç­¾ç½²æé†’
                </div>
            </template>
            <div style="width: 90%; margin: 0 auto">
                æ‚¨æœ‰
                <span style="color: red">{{ count }}</span>
                ä¸ªæœªç­¾ç½²çš„è¯æ®é“¾ç»Ÿè®¡æŠ¥å‘Šï¼Œè¯·å°½å¿«å®Œæˆç­¾ç½²ä»¥é¿å…å»¶è¯¯ã€‚
            </div>
            <span slot="footer" class="dialog-footer">
                <el-button @click="dClose">å– æ¶ˆ</el-button>
                <el-button type="primary" @click="goESign">å»ç­¾ç½²</el-button>
            </span>
        </el-dialog>
    </div >
    <div id="ywDialog" style="display: none;">
        <el-dialog title="ä¸šåŠ¡æ¨¡å¼å‡çº§æé†’" custom-class="business"  align-center  width="700px" :visible.sync="businessModelUpgradeNoticeVisible" :show-close="false" >
            <template slot="title">
                <div style="font-size: 20px">
                    ä¸šåŠ¡æ¨¡å¼å‡çº§æé†’
                </div>
            </template>
            <div style="width: 98%; margin: 0 auto">
                <el-card  shadow="always" style="background-color: #fbfbed;">
                    <div style="display: flex;align-items: center;">
                        <i class="el-icon-warning" style="color:   #E6A23C; font-size: 18px;margin-right: 5px;"></i>
                        <div v-if="loginStatus">æ‚¨æ‰€åœ¨çš„ä¼ä¸šï¼Œä¸šåŠ¡æ¨¡å¼å·²ä»ã€å·¥ä¸šç‰ˆã€‘å‡çº§ä¸ºã€æ ‡å‡†ç‰ˆã€‘ï¼Œéœ€è¦é‡æ–°ç™»å½•åç”Ÿæ•ˆ</div>
                        <div v-else>æ‚¨æ‰€åœ¨çš„ä¼ä¸šï¼Œä¸šåŠ¡æ¨¡å¼å·²ä»ã€å·¥ä¸šç‰ˆã€‘å‡çº§ä¸ºã€æ ‡å‡†ç‰ˆã€‘</div>
                    </div>
                </el-card>
                <div style="display: flex;justify-content: space-between;width: 90%;margin: 10px auto;">
                    <el-card  shadow="never" style="width: 49%;border: 1px solid #409EFF;  ">
                        <div style="display: flex;justify-content: space-between;">
                            <strong>å·¥ä¸šç‰ˆ</strong>
                            <div  style="color:#409EFF ;background: #f0f6fe;width: 80px;height: 20px;border-radius: 10px;text-align: center;">å½“å‰ç‰ˆæœ¬</div>
                         </div>
                     <div style="margin-left: 7px;margin-top: 5px;">
                        <div style="margin: 10px 0 5px 0;"><span> <i class="el-icon-circle-check" style="color: #409EFF;"></i></span>&nbsp;<span>ä»»åŠ¡å‘å¸ƒï¼ˆä»…é‚€è¯·ï¼‰</span></div>
                        <div  style="margin: 5px 0;"><span> <i class="el-icon-circle-check" style="color: #409EFF;"></i></span>&nbsp;<span>ä»»åŠ¡åˆ†é…åŠŸèƒ½</span></div>
                        <div  style="margin: 5px 0;"><span> <i class="el-icon-circle-check" style="color: #409EFF;"></i></span>&nbsp;<span>éªŒæ”¶åŠç»“ç®—åŠŸèƒ½</span></div>
                        <div  style="margin: 5px 0;"><span> <i class="el-icon-circle-close" style="color:red;"></i></span>&nbsp;<span>æ”¯ä»˜åŠå‘ç¥¨åŠŸèƒ½</span></div>
                        <div  style="margin: 5px 0;"><span> <i class="el-icon-circle-close" style="color:red;"></i></span>&nbsp;<span>æ‰¿æ¥ä»»åŠ¡</span></div>
                     </div>

                    </el-card>
                    <el-card  shadow="never" style="width: 49%;">
                        <div style="display: flex;justify-content: space-between;">
                            <strong>æ ‡å‡†ç‰ˆ</strong>
                            <div  style="color:black ;background: #ccc;width: 80px;height: 20px;border-radius: 10px;text-align: center;">å‡çº§å</div>
                         </div>
                     <div style="margin-left: 7px;margin-top: 5px;">
                        <div style="margin: 10px 0 5px 0;"><span> <i class="el-icon-circle-check" ></i></span>&nbsp;<span>ä»»åŠ¡å‘å¸ƒï¼ˆé‚€è¯·ã€æŠ¥ä»·ã€çµå·¥ï¼‰</span></div>
                        <div  style="margin: 5px 0;"><span> <i class="el-icon-circle-check" ></i></span>&nbsp;<span>ä»»åŠ¡åˆ†é…åŠŸèƒ½</span></div>
                        <div  style="margin: 5px 0;"><span> <i class="el-icon-circle-check" ></i></span>&nbsp;<span>éªŒæ”¶åŠç»“ç®—åŠŸèƒ½</span></div>
                        <div  style="margin: 5px 0;"><span> <i class="el-icon-circle-check" ></i></span>&nbsp;<span>æ”¯ä»˜åŠå‘ç¥¨åŠŸèƒ½</span></div>
                        <div  style="margin: 5px 0;"><span> <i class="el-icon-circle-check"></i></span>&nbsp;<span>æ‰¿æ¥ä»»åŠ¡</span></div>
                     </div>

                    </el-card>
                </div>
            </div>

            <span slot="footer" class="dialog-footer">
                <el-button @click="dCloses(1)" type="primary">ç¡®å®š</el-button>
            </span>
        </el-dialog>
    </div>

</div>

</body>
<script src="js/jquery.min.js"></script>

<script src="js/awen-ajax.js"></script>
<script src="js/index.js"></script>
<script src="js/menu.js"></script>
<script src="js/vue/vue.js"></script>
<script src="js/element/index.js"></script>
<script src="js/vue/qs.min.js"></script>
<script type="text/javascript" src="js/QVerify.min.js"></script>
<script type="text/JavaScript" src="js/util/crypto-js.min.js"></script>
<script>
    new Vue({
							el: '#vue',
							data() {
								return {
									dialogVisible: false,
									count: 0,
									tip: false,
                                    businessModelUpgradeNoticeVisible:false,
                                    loginStatus:false,
									dialogShow: false,
									message: 'æ‚¨çš„ä¼ä¸šæœªå¼€é€šç”µå­ç­¾æœåŠ¡ã€‚è¯·å°½å¿«å¼€é€šï¼Œä»¥ç¡®ä¿å·¥ä½œé¡ºåˆ©è¿›è¡Œã€‚',
									flag:true,
									sign:false,
                                    timeVisible: false,
                                    timeTitle: '',
                                    timeMessage: '',
								}
							},

							methods: {
								shutDown() {
									this.dialogVisible = false
									if(this.sign){
										this.getDownstreamSignStatus()
										this.sign = false
									}
									document.querySelector('#myDialog').style.display = 'none';
								},
								openUp() {
									$.ajax({
										url: `/lgb/user/checkEsignPermission`,
										method: 'GET',
									}).then(res => {

										if(res.code != 3001){
                                            localStorage.setItem('platform', 'sign')
                                            if (JSON.parse(localStorage.getItem('config')).identity == 'å·¥ä¸šä¼ä¸š') {
												window.open("/vue/#/taskEsignaContract/elecSignService")
											} else {
												window.open('/vue/#/supplierEsignaContract/elecSignService')
											}
										}else{
											this.$message.error(res.message);
										}
									})

								},
								dClose() {
									this.tip = false
									// $.ajax({
									// 	url: `/lgb/user/getUserName`,
									// 	method: 'POST',
									// }).then(res => {
									// 	if (!res.identity.includes('è¿è¥')) {
									// 		$.ajax({
									// 			url: `/lgb/user/getEsignActivationRemindersEnterprise`,
									// 			method: 'GET',
									// 		}).then(res => {
									// 			if (res.code == 0) {
									// 				if (res.data == false) {
									// 					this.dialogShow = true
									// 				}
									// 			}
									// 		})
									// 	}
									// })

								},
								goESign() {
									this.tip = false
									document.querySelector('#youDialog').style.display = 'none'; // æ˜¾ç¤ºå¯¹è¯æ¡†

								},
                                goAuthorize() {
                                    this.timeVisible = false
                                    $.ajax({
										url: `/lgb/user/reEpAuth`,
										method: 'GET',
									}).then(res => {
										if(res.code == 0){
                                    localStorage.setItem('goAuthorize','goAuthorize')
                                    localStorage.setItem('platform', 'sign')
                                    if(identity_alias == "å·¥ä¸šä¼ä¸š"){
                                        window.open(window.location.origin + "/vue/#/exception/defaultPage")
                                    } else if(identity_alias == "æœåŠ¡ä¼ä¸š"){
                                        console.log("ğŸš€ ~ goAuthorize ~ æœåŠ¡ä¼ä¸š:", identity_alias)
                                        window.open("/vue/#/supplierEsignaContract/elecSIgnActivated")
                                    }
										}else{
										}
									})
                                },
								go() {
									const list = document.querySelectorAll("#menu-jsp ul li")
									let flag = false
									for (let index = 0; index < list.length; index++) {
										if (list[index].innerText.replace(/\s+/g, '').trim().includes('ç­¾çº¦ä¸­å¿ƒ')) {
											flag = true
										}
									}
									if (flag) {
										window.open("/vue/#/taskEsignaContract/elecSignService")
										this.dialogShow = false
									} else {
										this.$message.error("æ‚¨æ²¡æœ‰æƒé™è®¿é—®ç”µå­ç­¾æœåŠ¡çš„å¼€é€šé¡µé¢ã€‚è¯·è”ç³»ç®¡ç†å‘˜ã€‚");
										// this.$alert('è¯·è”ç³»ç®¡ç†å‘˜å¼€é€šç”µå­ç­¾æœåŠ¡', {
										// 	confirmButtonText: 'ç¡®å®š',
										// })
									}

								},
								getDownstreamSignStatus(){
									let that = this
									const list = document.querySelectorAll("#menu-jsp ul li")
									let flagggg = false
									for (let index = 0; index < list.length; index++) {
										if (list[index].innerText.replace(/\s+/g, '').trim().includes('è¯æ®é“¾æ•°æ®ç®¡ç†')) {
											flagggg = true
										}
									}
									if(flagggg){
										$.get('user/getDownstreamSignStatus', (res) => {
										if (res.data != 0) {
											that.count = res.data
											document.querySelector('#youDialog').style.display = 'block'; // æ˜¾ç¤ºå¯¹è¯æ¡†
											that.tip = true
												}
											})
									}
								},
                                dCloses(type){


                                            $.ajax({url:`/lgb/corp/businessModelUpgradeNoticeConfirm`,method: 'POST',}).then(res => {
                                                this.businessModelUpgradeNoticeVisible = false
                                                document.querySelector('#ywDialog').style.display = 'none'; // éšè—å¯¹è¯æ¡†
                                                if(this.loginStatus){
                                                    top.location.href = "logout";
                                                }
                                                })

                                },

							},
							mounted: function () {
                                    $.ajax({url:`/lgb/corp/businessModelUpgradeNotice`,method: 'POST',}).then(res => {
                                    if(res.data!= 0){
                                if(SON.parse(localStorage.getItem('base')).user.corpId){

                                        document.querySelector('#ywDialog').style.display = 'block'; // æ˜¾ç¤ºå¯¹è¯æ¡†
                                        this.businessModelUpgradeNoticeVisible = true
                                    }
                                }

                                        })


                        // console.log('---------è¿›å…¥é¡µé¢',!localStorage.getItem("Authorization_trt"))
                        // if(!localStorage.getItem("Authorization_trt")){
                        //     console.log('---------é€€å‡ºç™»å½•')
                        //     location.href = "logout"
                        //     location.href='trtLogin/index.html'
                        // }
        				let that = this
        				window.addEventListener('message', function (event) {



        					if (event.data.action === 'openFullScreenDialog') {
        						// æ˜¾ç¤º Element UI å¯¹è¯æ¡†
        						event.source.postMessage({ action: 'dialogOpened' }, event.origin); // å¯é€‰ï¼Œç¡®è®¤å·²æ‰“å¼€
        						document.querySelector('#myDialog').style.display = 'block'; // æ˜¾ç¤ºå¯¹è¯æ¡†
        						that.dialogVisible = true
        					}else if(event.data.action === 'openFullScreenDialogs'){
        						that.flag = false
        						event.source.postMessage({ action: 'dialogOpened' }, event.origin); // å¯é€‰ï¼Œç¡®è®¤å·²æ‰“å¼€
        						document.querySelector('#myDialog').style.display = 'block'; // æ˜¾ç¤ºå¯¹è¯æ¡†
        						that.dialogVisible = true
        					}  else if (event.data.action === 'dialog') {
        						$.ajax({
        							url: `/lgb/user/getUserName`,
        							method: 'POST',
        						}).then(res => {
        							if (!res.identity.includes('è¿è¥')) {
        								$.ajax({url:`/lgb/user/getEsignActivationRemindersEnterprise`,method: 'GET',}).then(res => {
                                            if (res.data == false) {
                                                that.dialogVisible = true
                                                that.sign = true
                                                document.querySelector('#myDialog').style.display = 'block';
                                            }else{
                                                that.getDownstreamSignStatus()
                                            }
                                        })
        							}
        						})
        					}
        				});
                        const currentUrl = window.location.href
                        let loginCode = currentUrl.split('code=')[1]

                        layui.use(['element', 'layer', 'form', 'jquery', 'carousel', 'laydate', 'upload', 'table', 'flow', 'util', 'treeGrid', 'sliderVerify'], function () {
                            if (loginCode == "0") {
                            // rememberPwd();

                            setTimeout(function () {
                                layer.closeAll();
                                checkLicense(loginInit)
                                //    $("#corp-name").removeClass('corp-name').addClass('login-corp-name')
                                informationLackWarning();
                                platformReidProtocolCheck();
                                $("#menu-jsp").load("menu/menu.jsp");
                                element.render('nav');
                                $.get("user/getEnterpriseAuthInfo", function (res) {
                                    console.log("ğŸš€ ~ res:", res)
                                    var flag = ''
                                    if (res.data.expireFlag == 2) {
                                        flag = 'å°†äº'
                                        // è·å–id timeVisible
                                        let timeVisible = document.getElementById('timeVisible')
                                        timeVisible.style.display = 'block'
                                        that.timeVisible = true
                                        that.timeTitle = 'ç”µå­ç­¾æˆæƒå³å°†åˆ°æœŸæé†’'
                                        that.timeMessage = 'æ‚¨åœ¨eç­¾å®çš„æˆæƒ' + flag + res.data.expireTime +  'è¿‡æœŸï¼Œè¿‡æœŸåå°†æ— æ³•ä½¿ç”¨ç­¾ç« åŠŸèƒ½ï¼Œä¸ºäº†ä¸å½±å“æ‚¨çš„ä»»åŠ¡è¿›åº¦ï¼Œè¯·æ‚¨åŠæ—¶æˆæƒ'
                                    } else if (res.data.expireFlag == 3) {
                                        flag = 'å·²äº'
                                        let timeVisible = document.getElementById('timeVisible')
                                        timeVisible.style.display = 'block'
                                        that.timeVisible = true
                                        that.timeTitle = 'ç”µå­ç­¾æˆæƒå·²åˆ°æœŸæé†’'
                                        that.timeMessage = 'æ‚¨åœ¨eç­¾å®çš„æˆæƒ' + flag + res.data.expireTime +  'è¿‡æœŸï¼Œè¿‡æœŸåå°†æ— æ³•ä½¿ç”¨ç­¾ç« åŠŸèƒ½ï¼Œä¸ºäº†ä¸å½±å“æ‚¨çš„ä»»åŠ¡è¿›åº¦ï¼Œè¯·æ‚¨åŠæ—¶æˆæƒ'
                                    }
                                    // if (res.data.expireFlag == 2 || res.data.expireFlag == 3) {
                                    //     setTimeout(() => {
                                    //         var srt = "<div class='econtnt'>æ‚¨åœ¨eç­¾å®å¯¹åŒ»è¯è¥é”€æ•°æ™ºåŒ–ç³»ç»Ÿåº”ç”¨çš„æˆæƒ" + flag + res.data.expireTime + "è¿‡æœŸï¼Œè¿‡æœŸåå°†æ— æ³•ä½¿ç”¨ç­¾ç« åŠŸèƒ½ï¼Œä¸ºäº†ä¸å½±å“æ‚¨çš„ä»»åŠ¡è¿›åº¦ï¼Œè¯·æ‚¨åŠæ—¶æˆæƒ</div> "
                                    //         layer.open({
                                    //             type: 1,
                                    //             title: 'æ¸©é¦¨æç¤º',
                                    //             area: ['490px', '200px'],
                                    //             content: srt
                                    //             , btn: ['å¿½ç•¥', 'å»æˆæƒ']
                                    //             , btn1: function (index, layero) {
                                    //                 layer.close(index);
                                    //             }
                                    //             , btn2: function (index, layero) {
                                    //                 window.open("/vue/#/taskEsignaContract/elecSignService")

                                    //             }
                                    //             , cancel: function () {
                                    //                 //å³ä¸Šè§’å…³é—­å›è°ƒ
                                    //                 //return false å¼€å¯è¯¥ä»£ç å¯ç¦æ­¢ç‚¹å‡»è¯¥æŒ‰é’®å…³é—­
                                    //             }
                                    //         });
                                    //     }, 200)

                                    // }

                                })
                            }, 1500)
                        } else if (loginCode == "666") {
                                $.get("xymbgl/yhxyYszcSignStatus", function (res) {
                                    if(!res){
                                        let data = JSON.parse(sessionStorage.getItem('data'))
                                        // ç­¾ç½²åè®®-ç™»å½•ä¹‹åé¦–é¡µå±•ç¤º
                                        $("#xyzcForm [name=empId]").val(data.empId);
                                        $("#xyzcForm [name=empType]").val(data.empType);
                                        data = data.data;
                                        var h = "";
                                        for (var i = 0; i < data.length; i++) {
                                            let xyName = data[i].protocolType == 1 ? "ç”¨æˆ·åè®®" : "éšç§æ”¿ç­–";
                                            h += "<a onclick=xy('" + xyName + "','" + encodeURI(data[i].protocolText) + "')>ã€Š" + xyName + "ã€‹</a>";
                                            if (xyName == "ç”¨æˆ·åè®®") {
                                                $("[name=newYhxyId]").val("1");
                                                $("[name=newYhxyName]").val(data[i].xyName);
                                            }
                                            if (xyName == "éšç§æ”¿ç­–") {
                                                $("[name=newYszcId]").val("1");
                                                $("[name=newYszcName]").val(data[i].xyName);
                                            }
                                        }
                                        $(".xyzc").html(h);
                                        layer.open({
                                            id: 'awen',
                                            type: 1,
                                            title: false,
                                            skin: 'layui-layer-rim',
                                            content: $("#xy_zc_box"),
                                            area: ['400px', '460px'],
                                            cancel: function () {
                                                location.href = "logout"
                                                localStorage.removeItem("Authorization")
                                                // localStorage.removeItem("classFlag")
                                                // location.href='trtLogin/index.html'
                                            }
                                        })
                                    }
                                })

                        }
                        })

        			}
						})
    layui.config({
        base: 'layui/',
    }).extend({
        treeGrid: 'extends/treeGrid',
        sliderVerify: 'sliderVerify/sliderVerify'
    });
    var $;
    var loadIndex;
    var element;
    var treeGrid;
    var form;
    var upload;
    var layIndex;
    var layIndex2;
    var registIndex;
    var table;
    var tabObj;
    var layerSteward;
    var flow;
    var msgState;
    var laydate;

    var tabName;
    var tabText;
    var recIds;

    var unreadNo = 0;

    var imgIndex;
    var xyNames;
    var empIndex;
    var VerificationCodeState = false;
    var aCount = 0;
    var tempHeadImg_src = "";
    var restore_top = "";
    var restore_left = "";
    var min_top = "";
    var min_left = "";
    var restoreFist = true;
    var sponsorId;
    var sponsorName;
    window.addEventListener('click', function (event) {
							if (event.target.innerText == "å»ç­¾ç½²") {
								layer.open({
									type: 2,
									//   title: 'å®æ–½å·¥å•',
									title: false,
									skin: 'layui-layer-blank',
									area: ['100%', '100%'],
									content: "./xqf/implementationOrder.jsp"
								})
							}
							// document.querySelector("#dialog").style.display = 'none';
						})
    layui.use(['element', 'layer', 'form', 'jquery', 'carousel', 'laydate', 'upload', 'table', 'flow', 'util', 'treeGrid', 'sliderVerify'], function () {
        form = layui.form;
        var carousel = layui.carousel;
        element = layui.element;
        $ = layui.jquery;
        laydate = layui.laydate;
        upload = layui.upload;
        table = layui.table;
        flow = layui.flow;
        treeGrid = layui.treeGrid;
        util = layui.util;

        layui.data('config', {
            key: 'platform'
            , value: 'å‘èµ·æ–¹'
        });

        loginState();

        //è°ƒç”¨ç›‘å¬æ¶ˆæ¯æ–¹æ³•
        
        monitorMsg();
        

        rz_state = "0";
        identity_alias = "";

        //ç‚¹å‡»æ³¨å†ŒæŒ‰é’®
        $("#regist").click(function () {
            $("#registBox [name='phone']").val("");
            $("#registBox [name='captcha']").val("");
            $("#registBox [name='pwd']").val("");
            $("#registBox [name='pwd2']").val("");
            $("#registBox [name='corporation']").val("");
            $("#registBox [name='isRead']").attr("checked", false);
            form.render(null, 'registForm');

            $.post("xymbgl/yhxyYszc", function (d) {
                var h = "";
                xyNames = "";
                for (var i = 0; i < d.length; i++) {
                    h += "<a onclick=xy('" + d[i].xyName + "','" + encodeURI(d[i].xyContent) + "')>ã€Š" + d[i].xyName + "ã€‹</a>";
                    xyNames += "ã€Š" + d[i].xyName + "ã€‹";
                    if (d[i].xyType == "ç”¨æˆ·åè®®") {
                        $("#registBox [name=yhxyId]").val(d[i].id);
                        $("#registBox [name=yhxyName]").val(d[i].xyName);
                    }
                    if (d[i].xyType == "éšç§æ”¿ç­–") {
                        $("#registBox [name=yszcId]").val(d[i].id);
                        $("#registBox [name=yszcName]").val(d[i].xyName);
                    }
                }
                $(".xygl.yhzc").html("æˆ‘å·²é˜…è¯»å¹¶åŒæ„éµå®ˆ" + h);
                registIndex = layer.open({
                    id: 'awen',
                    type: 1,
                    id: 'registLay',
                    title: 'ç”¨æˆ·æ³¨å†Œ',
                    skin: 'layui-layer-lan',
                    area: ['420px'], //å®½é«˜
                    content: $('#registBox')
                })

            })
        })

        //ç›‘å¬ç™»å½•æäº¤
        form.on('submit(implementationForm)', function (data) {
            let loginMsgInfoDom = $("#loginMsgInfo");
            let layuiLayer1Dom = $("#layui-layer1");

            if (loginMsgInfoDom) {
                loginMsgInfoDom.css('display', 'none')
            }
            if (layuiLayer1Dom) {
                layuiLayer1Dom.css('height', '290px')
            }

            if (VerificationCodeState) {
                let cDisplay = $(".mode-captcha").css("display")
                if (cDisplay == 'none') {
                    // æ ¡éªŒå€¼æ˜¯å¦ä¸ºç©º
                    $('[name=loginCaptcha]').val('')
                } else {
                    loginCaptcha = $('[name=loginCaptcha]').val()
                    if (strIsEmpty(loginCaptcha)) {
                        layer.msg('è¯·è¾“å…¥éªŒè¯ç ', {icon: 5});
                        layer.close(loadIndex);
                        return false
                    }
                }
                loadIndex = layer.load();
                $("#loginSubmit").attr("disabled", true);
                var secretKey = CryptoJS.enc.Utf8.parse('secret5973164820');
                // ä½¿ç”¨AESåŠ å¯†
                var iv = CryptoJS.lib.WordArray.random(16)
                var ciphertext = CryptoJS.AES.encrypt($("#pwdPlaintext").val(), secretKey, {iv: iv}).toString();
                $("#implementationBox [name='pwd']").val(ciphertext)
                $("#implementationBox [name='iv']").val(iv.toString())
                var param = {
                    phone: $("#implementationBox [name='phone']").val(),
                    pwd: $("#implementationBox [name='pwd']").val(),
                    iv: $("#implementationBox [name='iv']").val(),
                    loginCaptcha: $("#implementationBox [name='loginCaptcha']").val()
                }
                $.post("user/login", {
                    phone: $("#implementationBox [name='phone']").val(),
                    pwd: $("#implementationBox [name='pwd']").val(),
                    iv: $("#implementationBox [name='iv']").val(),
                    loginCaptcha: $("#implementationBox [name='loginCaptcha']").val(),
                    sig: $('[name="sig"]').val(),
                    token: $('[name="token"]').val(),
                    cssessionId: $('[name="cssessionId"]').val(),
                    appKey: "FFFF0N0000000000B194",
                    scene: "nc_login",
                }, function (data, state, xhr) {
                    setTimeout(function () {
                        $("#loginSubmit").attr("disabled", false);
                    }, 2000)
                    $("[name=ignoreCaptcha]").val("0");
                    layer.close(loadIndex);
                    if (data.token) {
                        let token = {
                            'token': data.token
                        }
                        localStorage.setItem("Authorization", encodeURIComponent(JSON.stringify(token)))
                    }
                    if (data.code == "0") {
                        rememberPwd();

                        setTimeout(function () {
                            layer.closeAll();
                            checkLicense(loginInit)
                            //    $("#corp-name").removeClass('corp-name').addClass('login-corp-name')
                            informationLackWarning();
                            platformReidProtocolCheck();
                            $("#menu-jsp").load("menu/menu.jsp");
                            element.render('nav');
                            $.get("user/getEnterpriseAuthInfo", function (res) {
                                var flag = ''
                                if (res.data.expireFlag == 2) {
                                        flag = 'å°†äº'
                                        // è·å–id timeVisible
                                        let timeVisible = document.getElementById('timeVisible')
                                        timeVisible.style.display = 'block'
                                        that.timeVisible = true
                                        that.timeTitle = 'ç”µå­ç­¾æˆæƒå³å°†åˆ°æœŸæé†’'
                                        that.timeMessage = 'æ‚¨åœ¨eç­¾å®çš„æˆæƒ' + flag + res.data.expireTime +  'è¿‡æœŸï¼Œè¿‡æœŸåå°†æ— æ³•ä½¿ç”¨ç­¾ç« åŠŸèƒ½ï¼Œä¸ºäº†ä¸å½±å“æ‚¨çš„ä»»åŠ¡è¿›åº¦ï¼Œè¯·æ‚¨åŠæ—¶æˆæƒ'
                                    } else if (res.data.expireFlag == 3) {
                                        flag = 'å·²äº'
                                        let timeVisible = document.getElementById('timeVisible')
                                        timeVisible.style.display = 'block'
                                        that.timeVisible = true
                                        that.timeTitle = 'ç”µå­ç­¾æˆæƒå·²åˆ°æœŸæé†’'
                                        that.timeMessage = 'æ‚¨åœ¨eç­¾å®çš„æˆæƒ' + flag + res.data.expireTime +  'è¿‡æœŸï¼Œè¿‡æœŸåå°†æ— æ³•ä½¿ç”¨ç­¾ç« åŠŸèƒ½ï¼Œä¸ºäº†ä¸å½±å“æ‚¨çš„ä»»åŠ¡è¿›åº¦ï¼Œè¯·æ‚¨åŠæ—¶æˆæƒ'
                                    }
                                // if (res.data?.expireFlag == 2 || res.data?.expireFlag == 3) {
                                //     setTimeout(() => {
                                //         var srt = "<div class='econtnt'>æ‚¨åœ¨eç­¾å®çš„æˆæƒ" + flag + res.data.expireTime + "è¿‡æœŸï¼Œè¿‡æœŸåå°†æ— æ³•ä½¿ç”¨ç­¾ç« åŠŸèƒ½ï¼Œä¸ºäº†ä¸å½±å“æ‚¨çš„ä»»åŠ¡è¿›åº¦ï¼Œè¯·æ‚¨åŠæ—¶æˆæƒ</div> "
                                //         layer.open({
                                //             type: 1,
                                //             title: 'æ¸©é¦¨æç¤º',
                                //             area: ['490px', '200px'],
                                //             content: srt
                                //             , btn: ['å¿½ç•¥', 'å»æˆæƒ']
                                //             , btn1: function (index, layero) {
                                //                 layer.close(index);
                                //             }
                                //             , btn2: function (index, layero) {
                                //                 window.open("/vue/#/taskEsignaContract/elecSignService")

                                //             }
                                //             , cancel: function () {
                                //                 //å³ä¸Šè§’å…³é—­å›è°ƒ
                                //                 //return false å¼€å¯è¯¥ä»£ç å¯ç¦æ­¢ç‚¹å‡»è¯¥æŒ‰é’®å…³é—­
                                //             }
                                //         });
                                //     }, 200)

                                // }

                            })
                        }, 1500)
                    } else if (data.code == "666") {
                        $("#xyzcForm [name=empId]").val(data.empId);
                        $("#xyzcForm [name=empType]").val(data.empType);
                        data = data.data;
                        var h = "";
                        for (var i = 0; i < data.length; i++) {
                            let xyName = data[i].protocolType == 1 ? "ç”¨æˆ·åè®®" : "éšç§æ”¿ç­–";
                            h += "<a onclick=xy('" + xyName + "','" + encodeURI(data[i].protocolText) + "')>ã€Š" + xyName + "ã€‹</a>";
                            if (xyName == "ç”¨æˆ·åè®®") {
                                $("[name=newYhxyId]").val("1");
                                $("[name=newYhxyName]").val(data[i].xyName);
                            }
                            if (xyName == "éšç§æ”¿ç­–") {
                                $("[name=newYszcId]").val("1");
                                $("[name=newYszcName]").val(data[i].xyName);
                            }
                        }
                        // for (var i = 0; i < data.length; i++) {
                        //     h += "<a onclick=xy('" + data[i].xyName + "','" + encodeURI(data[i].xyContent) + "')>ã€Š" + data[i].xyName + "ã€‹</a>";
                        //     if (data[i].xyType == "ç”¨æˆ·åè®®") {
                        //         $("[name=newYhxyId]").val(data[i].id);
                        //         $("[name=newYhxyName]").val(data[i].xyName);
                        //     }
                        //     if (data[i].xyType == "éšç§æ”¿ç­–") {
                        //         $("[name=newYszcId]").val(data[i].id);
                        //         $("[name=newYszcName]").val(data[i].xyName);
                        //     }
                        // }
                        $(".xyzc").html(h);
                        layer.open({
                            id: 'awen',
                            type: 1,
                            title: false,
                            skin: 'layui-layer-rim',
                            content: $("#xy_zc_box"),
                            area: ['400px', '460px'],
                            cancel: function () {
                                location.href = "logout"
                            }
                        })
                        // VerificationCodeState = false
                    } else if (data.code == "-3") {
                        let messageStr = data.message.replace(`<a>`, `<a href='javascript:void(0)' style='color:#1E9FFF;' class="onclickForgetPwd">`);
                        loginMsgInfoDom.html(messageStr);

                        if (loginMsgInfoDom) {
                            loginMsgInfoDom.css('display', 'block')
                        }
                        if (layuiLayer1Dom) {
                            layuiLayer1Dom.css('height', '320px')
                        }

                        resetNc()
                        VerificationCodeState = false
                    } else {

                        resetNc()
                        VerificationCodeState = false
                        layer.alert(data.message, {icon: 5});
                    }
                })
                return false;
            } else {
                resetNc()
                if (aCount > 0) {
                    layer.msg("è¯·å…ˆé€šè¿‡ç™»å½•éªŒè¯!");
                }
                aCount++;
            }
            return false;
        });

        $("#getCaptchaBtn").click(function () {
            let phone = $("#implementationBox [name=phone]").val();
            let reg = /^1\d{10}$/;
            if (reg.test(phone)) {
                // æ ¡éªŒå¯†ç å¿…å¡«
                let pwd = $("#implementationBox [name=pwd]").val();
                if (strIsEmpty(pwd)) {
                    layer.msg("è¯·å…ˆè¾“å…¥å¯†ç ï¼");
                    return false
                }
                $.get("system/param/sendMsgCode", {mobile: phone, verifyCodeType: 'LOGIN'}, function (d) {
                    if (d.code == 200) {
                        $("#getCaptchaBtn").attr("disable", true);
                        $("#getCaptchaBtn").addClass("layui-btn-disabled");
                        let t = 60;
                        let clock = setInterval(function () {
                            if (t > 0) {
                                t--;
                                $("#getCaptchaBtn").html(t + "s");
                            } else {
                                clearInterval(clock);
                                $("#getCaptchaBtn").html("é‡æ–°è·å–");
                                $("#getCaptchaBtn").attr("disable", false);
                                $("#getCaptchaBtn").removeClass("layui-btn-disabled");
                            }
                        }, 1000);
                    } else {
                        layer.msg(d.message, {icon: 5});
                    }
                })
            } else {
                $("#implementationBox [name=phone]").focus();
                layer.msg("è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·");
            }
        })
        $("body").delegate(".onclickForgetPwd", "click", function (e) {
            // è§¦å‘å¿˜è®°å¯†ç 
            $(".forgetPwd").click();
        })
    })

    function resetNc() {
        $('[name="cssessionId"]').val('')
        $('[name="sig"]').val('')
        $('[name="token"]').val('')
        window.nc.reset()
    }


    function loginInit() {
        // reloadMain();
        showAdvise();
        loginState();
        overdueReminder();
        monitorMsg();
        chatUnReadCount();
    }

    function chatUnReadCount() {
        $.post("chat/unReadCount", function (res) {
            if (res != "0") {  //æœ‰æœªè¯»æ¶ˆæ¯
                //æ’­æ”¾æ¶ˆæ¯æç¤ºéŸ³
                $("#msgMp3").remove();
                $("body").append('<audio id="msgMp3"  style="display:none"  src="voice/msg.mp3"  autoplay></audio>');
                setTimeout(function () {
                    $(".myHeadImg").addClass("warningImg");
                }, 500)
            }
        })
    }

    /*è®¾ç½®ç™»å½•çŠ¶æ€ä¸‹æ‹‰*/
    function loginState(noChat) {
        sponsorId = "";
        sponsorName = "";
        $.ajax({
            type: 'POST',
            url: 'user/getUserName',
            async: false,
            success: function (data, status, xhr) {
                rz_state = data.rZ_STATE;
                identity_alias = data.identity_alias;
                //$(".layui-nav-tree").css("display", "none");
                layui.data('base', {
                    key: 'user'
                    , value: data
                });

                if (data.employeeName != undefined) {
                    layui.data('config', {
                        key: 'identity'
                        , value: data.identity_alias
                    });
                }

                if (data.employeeName == undefined || data.identity == "éœ€æ±‚ä¼ä¸š" || data.identity == "è¿è¥æ–¹") {
                    $("#sso").css("display", "block");
                    $("#sso").off("click");
                    if (data.employeeName == undefined) {
                        $("#sso").on("click", function () {
                            layer.open({
                                btn: ['å»ç™»å½•'],
                                type: 1,
                                title: 'æ¸©é¦¨æç¤º',
                                skin: 'layui-layer-rim',
                                content: $("#tipsBox"),
                                btn1: function (index, layero) {
                                    layer.close(index);
                                    $("#implementation").click();
                                }
                            });
                        })
                    } else {
                        $("#sso").on("click", function () {
                            location.href = "index_xqf.jsp";
                        });
                    }

                } else {
                    $("#sso").css("display", "none");
                }

                if (data.employeeName != undefined) {

                    if (data.identity != "è‡ªç„¶äºº") {
                        $("#xzBtn").css("display", "block");
                    }

                    if (noChat == undefined) {
                        beforeChatHandle();
                    }
                    var setting = "";
                    empCode = data.employeeCode;
                    var rz = "";
                    var qyrz = "";
                    if (data.rZ_STATE == "0") {
                        rz = "<button type=button class='layui-btn layui-btn-sm layui-btn-primary' >æœªè®¤è¯</button>"
                    } else if (data.rZ_STATE == "1") {
                        rz = "<button type=button class='layui-btn layui-btn-xs layui-btn-warm' >è®¤è¯ä¸­</button>";
                    } else if (data.rZ_STATE == "2") {
                        rz = "<button type=button class='layui-btn layui-btn-xs' >å·²è®¤è¯</button>";
                    } else if (data.rZ_STATE == "3") {
                        rz = "<button type=button class='layui-btn layui-btn-xs layui-btn-danger'>è®¤è¯å¤±è´¥</button>";
                    } else if (data.rZ_STATE == "4") {
                        rz = "<button type=button class='layui-btn layui-btn-xs layui-btn-danger'>è¯ä»¶å·²è¿‡æœŸ</button>";
                    }
                    $("#RZ_STATE").append(rz);

                    var jrqy = '';
                    var cjqy = '';
                    var empName = data.realName;
                    if (data.identity == "éœ€æ±‚ä¼ä¸š") {
                        if (data.corpId != "") {
                            empName += '(' + data.corpName + ')';
                            //cjqy='<dd><a href="javascript:void(0)" id="qyxq"><i class="fa fa-paw fa-fw"></i>ä¼ä¸šè¯¦æƒ…</a></dd>';
                            //qyrz='<dd><a href="javascript:void(0)" id="qyrz"><i class="fa fa-address-card fa-fw"></i>ä¼ä¸šè®¤è¯</a></dd>';
                        } else {
                            /*
                             //éœ€æ±‚å˜æ›´ä¼ä¸šç”±è¿è¥æ–¹åˆ›å»º
                            jrqy = '<dd><a href="javascript:void(0)" id="jrqy"><i class="fa fa-tint fa-fw"></i>åŠ å…¥ä¼ä¸š</a></dd>';
                             if (data.rZ_STATE=="2"){
                                 cjqy = '<dd><a href="javascript:void(0)" id="cjqy"><i class="fa fa-paw fa-fw"></i>åˆ›å»ºä¼ä¸š</a></dd>';
                             }else {
                                 cjqy = '<dd><a href="javascript:void(0)" id="cjqyts" onclick="cjqyts()"><i class="fa fa-paw fa-fw"></i>åˆ›å»ºä¼ä¸š</a></dd>';
                             }*/
                        }
                        if (data.identity_alias == "å·¥ä¸šä¼ä¸š") {
                            //$(".menu-xqqy").css("display", "block");
                            $("#publishBtn2").css("display", "block");
                            $("#menuLi").css("display", "inline-block");
                            sponsorId = data.corpId;
                            sponsorName = data.corpName;
                        } else {  //æœåŠ¡ä¼ä¸š
                            //$(".menu-zrr").css("display", "block");
                            $("#publishBtn2").css("display", "none");
                            $("#menuLi").css("display", "inline-block");
                            $("#publishBtn2").css("display", "none");

                        }
                        if (data.corpId == "") {
                            $("#menuLi").css("display", "none");
                        }
                        $("#tzgg").css("display", "none");
                    } else if ("è‡ªç„¶äºº" == data.identity) {
                        $("#publishBtn2").css("display", "none");
                        $("#menuLi").css("display", "inline-block");
                    } else {
                        $("#publishBtn2").css("display", "none");
                        $("#menuLi").css("display", "inline-block");
                    }

                    var headImg = data.headImg == "" ? "images/headImg.png" : data.headImg + "?v=" + Math.floor(Math.random() * 100000);

                    var u = '<a hrindexef="javascript:void(0)"><img  id="topHeadImg" src="' + headImg + '" style="width:32px;height:32px;border-radius:16px;margin-right:5px">' + empName + '</a>'
                        + '<dl class="layui-nav-child">'
                    if (data.identity !== "è‡ªç„¶äºº") {
                        u += '<dd><a href="javascript:void(0)" id="myInfo"><i class="fa fa-user-circle-o fa-fw"></i>ç”¨æˆ·è¯¦æƒ…</a></dd>';
                    }
                    if (data.identity == "éœ€æ±‚ä¼ä¸š") {
                        u += jrqy;
                        if (data.corpId == "") {
                            u += '<dd><a href="javascript:void(0)" id="rz"><i class="fa fa-address-card fa-fw"></i>èº«ä»½è®¤è¯</a></dd>';
                        }
                        u += cjqy;
                        //u+=qyrz;
                    }
                    if (data.identity !== "è‡ªç„¶äºº") {
                        u += '<dd><a href="javascript:void(0)" id="sjhb"><i class="fa fa-exchange fa-fw"></i>æ‰‹æœºæ¢ç»‘</a></dd>';
                        u += '<dd><a href="javascript:void(0)" id="czmm"><i class="fa fa-key fa-fw"></i>ä¿®æ”¹å¯†ç </a></dd>';
                    }
                    u += '<dd><a href="userLogout" id="logout"><i class="fa fa-power-off fa-fw"></i>é€€å‡ºç™»å½•</a></dd>';
                    u += '</dl>';

                    $("#u").html(u);
                    var xxts = layui.data('xxts');
                    if (xxts.isShow != "false") {
                        $("#xxts").attr("checked", "checked");
                    } else {
                        $("#xxts").attr("checked", false);
                    }
                    form.render("checkbox", "settingFilter");
                    unreadCount();

                    element.render('nav');

                    $("#registLi").css("display", "none");
                    $("#screenLi").css("display", "inline-block");
                } else {
                    $("#publishBtn2").css("display", "block");
                    $("#menuLi").css("display", "none");
                }

            }
        })
    }


    /*ç›‘å¬æœåŠ¡å™¨å‘æ¥çš„æ¶ˆæ¯*/
    var lockReconnect = false;       //é¿å…wsé‡å¤è¿æ¥
    ws = null;               // åˆ¤æ–­å½“å‰æµè§ˆå™¨æ˜¯å¦æ”¯æŒWebSocket
    var empCode = "";
    let hostname = window.location.hostname;

    function monitorMsg() {
        // 
        if(hostname == "localhost"){
            wsUrl = "ws://" + hostname + ":8080/lgb/websocket/" + empCode
        }else{
            // wsUrl = "wss://" + hostname + "/lgb/websocket/" + empCode
            var wsUrl = "wss://zxyy.ltd/lgb/websocket/" + empCode;
        }
        try {
            if ('WebSocket' in window) {
                if (empCode != "") {
                    if (ws != null) {
                        ws.close();//æ–­å¼€ç™»å½•ä¹‹å‰çš„æ¸¸å®¢è¿æ¥
                    }
                    ws = new WebSocket(wsUrl);
                } else {
                    var tempChat = layui.data('tempChat');
                    var chatId = '1757599972203101';
                    if (tempChat.id != null) {
                        chatId = tempChat.id;
                    }
                    // 
                    if(hostname == "localhost"){
                        // MSG_WBBSOCKET_TRT_URL
                        ws = new WebSocket("ws://" + hostname + ":8080/lgb/websocket/"+ chatId) // å»ºç«‹è¿æ¥
                    }else{
                        // ws = new WebSocket("wss://" + hostname + "/lgb/websocket/"+ chatId)
                        ws = new WebSocket("wss://zxyy.ltd/lgb/websocket/" + chatId)
                    }
                    layui.data('tempChat', {key: 'id', value: chatId});
                }
            }
            initEventHandle();
        } catch (e) {
            reconnect();
            console.log(e);
        }
    }

    function initEventHandle() {
        ws.onclose = function () {
            reconnect();
            // console.log("wsè¿æ¥å…³é—­!" + new Date().toLocaleString());
        };
        ws.onerror = function () {
            reconnect();
            console.log("wsè¿æ¥é”™è¯¯!");
        };
        ws.onopen = function () {
            heartCheck.reset().start();      //å¿ƒè·³æ£€æµ‹é‡ç½®
            // console.log("wsè¿æ¥æˆåŠŸ!" + new Date().toLocaleString());
        };
        ws.onmessage = function (event) {    //å¦‚æœè·å–åˆ°æ¶ˆæ¯ï¼Œå¿ƒè·³æ£€æµ‹é‡ç½®
            heartCheck.reset().start();      //æ‹¿åˆ°ä»»ä½•æ¶ˆæ¯éƒ½è¯´æ˜å½“å‰è¿æ¥æ˜¯æ­£å¸¸çš„
            if (event.data != 'pong') {
                var res = JSON.parse(event.data);
                if ($("#xxts").prop("checked") == true) {
                    msgType = res.msgType;
                    if (msgType == "ä¸šåŠ¡æ¨¡å¼") {
                        document.querySelector('#ywDialog').style.display = 'block'; // æ˜¾ç¤ºå¯¹è¯æ¡†
                        var vueApp = document.querySelector('#vue').__vue__;
                        vueApp.loginStatus = true
                        vueApp.businessModelUpgradeNoticeVisible = true;
                        //Small Dragon TODO
                    } else if (msgType == "ä¸‹çº¿é€šçŸ¥") {
                        let currentClientType = 'jlf';
                        console.log(currentClientType);
                        console.log(res.msgClientType);
                        if (res.msgClientType && currentClientType !== res.msgClientType) {
                            return;
                        }
                        empCode = "";
                        layer.alert(res.msgContent, {
                            title: msgType, skin: 'layui-layer-red', closeBtn: 0, yes: function () {
                                location.href = "logout";
                            }
                        });
                    } else if (msgType == "å³æ—¶é€šè®¯") {
                        //æ’­æ”¾æ¶ˆæ¯æç¤ºéŸ³
                        $("#msgMp3").remove();
                        $("body").append('<audio id="msgMp3"  style="display:none"  src="voice/msg.mp3"  autoplay></audio>');
                        //åˆ·æ–°ä¼šè¯åˆ—è¡¨
                        loadChatUser(res.sendEmpId);
                        //å¤´åƒé—ªåŠ¨ (åŠ å»¶è¿Ÿä¿è¯loadChatUseræ‰§è¡Œå®Œï¼Œä¸ç„¶å¤´åƒæœ‰æ—¶æ˜¯è‡ªå·±çš„æœ‰æ—¶çš„å‘æ¶ˆæ¯è€…çš„)
                        setTimeout(function () {
                            $(".myHeadImg").addClass("warningImg");
                        }, 200)
                        //å¤´åƒä¸Šæ–¹æ¥ä¸ªæç¤º ï¼Œå¦‚æœå­˜åœ¨å¯¹åº”çš„æœªè¯»æé†’å°±åŠ 1ï¼Œå¦åˆ™å°±æ·»åŠ æé†’
                        //è¿™åŠŸèƒ½å…ˆä¸åš
                    } else {
                        relevantId = res.relevantId;
                        unreadCount();
                        loginState("noChat");//èº«ä»½è®¤è¯çš„çŠ¶æ€å˜åŒ–éœ€è¦åŠæ—¶ä¿®æ”¹å¥½
                        if (msgType == "ä»»åŠ¡è¯¦æƒ…" || msgType == "ä»»åŠ¡åˆ†é…" || msgType == "ä»»åŠ¡éªŒæ”¶" || msgType == "ä»»åŠ¡ç»“ç®—" || msgType == "ä»˜æ¬¾ç¡®è®¤") {
                            search();
                        }
                        setTimeout(function () {
                            var content = "";
                            if (unreadNo != "0") {
                                content += '<p>ç›®å‰å…±æœ‰<span>' + unreadNo + '</span>æ¡æœªè¯»æ¶ˆæ¯<a href="javascript:void(0)" id="myMsg2">ç‚¹å‡»æŸ¥çœ‹</a></p>';
                            }
                            content += '<p class="msgTitle">ã€' + res.msgTitle + 'ã€‘</p>';
                            content += '<p id="msg-pc" style="text-align:left;text-indent:35px;">' + res.msgContent + '</p>';
                            content += '<div class="notnotice" onclick="readNow(' + res.msgId + ')" >å·²è¯»</div>';
                            content += '<audio style="display:none" src="http://fanyi.baidu.com/gettts?lan=zh&amp;text=' + res.msgContent + '&amp;spd=5&amp;sorce=web" autoplay></audio>';
                            var h = 185;
                            if (res.msgContent.indexOf("ä»»åŠ¡") != -1 && res.msgContent.length > 70) {
                                h = 215;
                            }
                            if(res.applyPlatform==2){
                                return
                            }
                            layer.close(layerSteward);
                            layerSteward = layer.open({
                                type: 1,
                                title: 'æ¶ˆæ¯æé†’',
                                shade: 0,
                                resize: false,
                                area: ['340px', h + 'px'],
                                skin: 'steward',
                                offset: 'lb',
                                closeBtn: 1,
                                anim: 2,
                                zIndex: 199702060,
                                content: content
                            });
                        }, 1000)

                    }

                }
            }


        }
    }


    var nc_token = ["FFFF0N0000000000B194", (new Date()).getTime(), Math.random()].join(':');
    var NC_Opt =
        {
            renderTo: "#your-dom-id",
            appkey: "FFFF0N0000000000B194",
            scene: "nc_login",
            token: nc_token,
            customWidth: '100%',
            trans: {"key1": "code0"},
            elementID: ["usernameID"],
            is_Opt: 0,
            language: "cn",
            isEnabled: true,
            timeout: 3000,
            times: 5,
            callback: function (data) {
                if (data.value === 'pass') {
                    $('[name="cssessionId"]').val(data.csessionid)
                    $('[name="sig"]').val(data.sig)
                    $('[name="token"]').val(data.token)
                    VerificationCodeState = true
                } else {
                    resetNc()
                    VerificationCodeState = false
                }
            }
        }
    var nc = new noCaptcha(NC_Opt)
    nc.upLang('cn', {
        _startTEXT: "è¯·æŒ‰ä½æ»‘å—ï¼Œæ‹–åŠ¨åˆ°æœ€å³è¾¹",
        _yesTEXT: "éªŒè¯é€šè¿‡",
        _error300: "å“å‘€ï¼Œå‡ºé”™äº†ï¼Œç‚¹å‡»<a href=\"javascript:__nc.reset()\">åˆ·æ–°</a>å†æ¥ä¸€æ¬¡",
        _errorNetwork: "ç½‘ç»œä¸ç»™åŠ›ï¼Œè¯·<a href=\"javascript:__nc.reset()\">ç‚¹å‡»åˆ·æ–°</a>",
    })


    // ç›‘å¬çª—å£å…³é—­äº‹ä»¶ï¼Œå½“çª—å£å…³é—­æ—¶ï¼Œä¸»åŠ¨å»å…³é—­websocketè¿æ¥ï¼Œé˜²æ­¢è¿æ¥è¿˜æ²¡æ–­å¼€å°±å…³é—­çª—å£ï¼Œserverç«¯ä¼šæŠ›å¼‚å¸¸ã€‚
    window.onbeforeunload = function () {
        ws.close();
    }

    function reconnect() {
        if (lockReconnect) return;
        lockReconnect = true;
        setTimeout(function () {     //æ²¡è¿æ¥ä¸Šä¼šä¸€ç›´é‡è¿ï¼Œè®¾ç½®å»¶è¿Ÿé¿å…è¯·æ±‚è¿‡å¤š
            monitorMsg();
            lockReconnect = false;
        }, 2000);
    }

    //å¿ƒè·³æ£€æµ‹
    var heartCheck = {
        timeout: 60000,  //1åˆ†é’Ÿå‘ä¸€æ¬¡å¿ƒè·³
        timeoutObj: null,
        serverTimeoutObj: null,
        reset: function () {
            clearTimeout(this.timeoutObj);
            clearTimeout(this.serverTimeoutObj);
            return this;
        },
        start: function () {
            var self = this;
            this.timeoutObj = setTimeout(function () {
                ws.send("ping");
                console.log("ping!");
                self.serverTimeoutObj = setTimeout(function () {//å¦‚æœè¶…è¿‡ä¸€å®šæ—¶é—´è¿˜æ²¡é‡ç½®ï¼Œè¯´æ˜åç«¯ä¸»åŠ¨æ–­å¼€äº†
                    ws.close();     //å¦‚æœoncloseä¼šæ‰§è¡Œreconnectï¼Œæˆ‘ä»¬æ‰§è¡Œws.close()å°±è¡Œäº†.å¦‚æœç›´æ¥æ‰§è¡Œreconnect ä¼šè§¦å‘oncloseå¯¼è‡´é‡è¿ä¸¤æ¬¡
                }, self.timeout)
            }, this.timeout)
        }
    }

    function jrqyts() {
        layer.tips('è¯·å…ˆé€šè¿‡èº«ä»½è®¤è¯æ‰èƒ½åŠ å…¥ä¼ä¸šï¼', '#jrqyts', {
            tips: [1, "#4794ec"]
            , time: 1500
        });
    }

    function cjqyts() {
        layer.tips('è¯·å…ˆé€šè¿‡èº«ä»½è®¤è¯æ‰èƒ½åˆ›å»ºä¼ä¸šï¼', '#cjqyts', {
            tips: [1, "#4794ec"]
            , time: 1500
        });
    }

    // ç›‘å¬ localStorage å˜åŒ–
    window.addEventListener('storage', function(e) {
        if(e.key === 'aboutUsTab') {
            // æ›´æ–°å¯¼èˆªæ é€‰ä¸­çŠ¶æ€
            $('.layui-nav-item').removeClass('layui-this');
            $('.layui-nav-item a').each(function() {
                if($(this).attr('onclick') && $(this).attr('onclick').indexOf(e.newValue) > -1) {
                    $(this).parent().addClass('layui-this');
                }
            });
        }
    });

    // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥ localStorage ä¸­çš„å€¼
    $(document).ready(function() {
        var currentTab = localStorage.getItem('aboutUsTab');
        if(currentTab) {
            $('.layui-nav-item').removeClass('layui-this');
            $('.layui-nav-item a').each(function() {
                if($(this).attr('onclick') && $(this).attr('onclick').indexOf(currentTab) > -1) {
                    $(this).parent().addClass('layui-this');
                }
            });
        }
    });
</script>
</html>
